<?xml version="1.0" encoding="iso-8859-9" ?>
<item>
<eklenti_adi>Galeri Sistemi</eklenti_adi>
<aspcode><![CDATA[
Response.Write "<title>"&siteadi&"</title>"
deste = 25
If Request.QueryString("s") <> "" Then 
  Sayfa = CInt(Request.QueryString("s"))
Else 
  Sayfa = 1 
End If 

Response.Write "<table width=""100%"" border=""0"" cellpadding=""3"" cellspacing=""3""><tr><td colspan=""4""><strong>"& picture_gallery &"</strong></td></tr><tr><td height=""25"" colspan=""4"">"& category &"</td></tr><tr><td height=""25"" colspan=""4"">* <a href=""default.asp?islem=bilesen&component=galeri"">"& all &"</a> *  "
  
set rs = baglanti.Execute("select * from gop_galerikat order by galkat asc")
if rs.eof or rs.bof then
Response.Write not_category
else
do while not rs.eof
Response.Write "<a href=default.asp?islem=bilesen&component=galeri&act=kategori&galid="&rs("galid")&">" & rs("galkat") & "</a> * "
rs.MoveNext
loop
rs.close
set rs=nothing

end if

Response.Write "</td></tr><tr>"


act = request.querystring("act")
if act = "goster" then
call goster
elseif act = "kategori" then
call kategori
elseif act = "" then
call ilk
end if

sub ilk

set gs = baglanti.Execute("select * from gop_galeri order by resid DESC LIMIT "& (deste*Sayfa)-(deste) & "," & deste)

Set SQLToplam = baglanti.Execute("select count(resid) from gop_galeri") 
if gs.eof or gs.bof then
Response.Write not_picture
else
TopKayit = SQLToplam(0) 

for z=1 to deste
if  gs.eof then exit for

Response.Write "<td><table><tr><td><b>"& gs("resadi") &"</b></td></tr><tr><td><a href=default.asp?islem=bilesen&component=galeri&act=goster&resid="&gs("resid")&" border=0><img src="& gs("resresim") &" width=""100""  align=""left"" onerror=""this.src='images/joomlasp.jpg'""></a></td></tr></td></tr><tr><td><strong>"&hit&":</strong>" & gs("rhit") & "</td>  </tr></table></td>"

if z mod 5 = 0 then response.write "</tr><tr>"

gs.MoveNext
next
gs.close
set gs=nothing
end if

Response.Write "</tr></table>"

' Istatistik bilgileri
Response.Write "<table width=""100%"" border=""0""><tr><td><strong>"& last_10_picture &"</strong></td><td><strong>"& hit_10_picture &"</strong></td><td><strong>"& down_10_picture &"</strong></td></tr><tr><td>"
  
   
set resson = baglanti.Execute("select * from gop_galeri order by resid DESC LIMIT 10")
do while not resson.eof
Response.Write "<a href=default.asp?islem=bilesen&component=galeri&act=goster&resid="&resson("resid")&" class=""smlink"">"&resson("resadi") & "</a><br>"
resson.movenext
loop
resson.close
set resson=nothing

Response.Write "</td><td>"

set reshit = baglanti.Execute("select * from gop_galeri order by rhit DESC LIMIT 10")
do while not reshit.eof
Response.Write "<a href=default.asp?islem=bilesen&component=galeri&act=goster&resid="&reshit("resid")&" class=""smlink"">"&reshit("resadi") & "</a><br>"
reshit.movenext
loop
reshit.close
set reshit=nothing
 Response.Write "</td><td>"
set resbot = baglanti.Execute("select * from gop_galeri order by rhit asc LIMIT 10")
do while not resbot.eof
Response.Write "<a href=default.asp?islem=bilesen&component=galeri&act=goster&resid="&resbot("resid")&" class=""smlink"">"&resbot("resadi") & "</a><br>"
resbot.movenext
loop
resbot.close
set resbot=nothing

Response.Write "</td></tr></table>"

' Istatistik sonu

Response.Write "<div align=""center"">"

If CInt(TopKayit) > CInt(deste) Then 
SayfaSayisi = CInt(TopKayit) / CInt(deste) 
If InStr(1,SayfaSayisi,",",1) > 1 Then SayfaSayisi = CInt(Left(SayfaSayisi,InStr(1,SayfaSayisi,",",1))) + 1 

If SayfaSayisi > 1 Then 
Response.Write "<a class=pagenav href=?islem=bilesen&component=galeri&s=1><< "&start_page&"</a> "
if Sayfa = 1 then
Response.Write ""
else
Response.Write "<a class=pagenav href=?islem=bilesen&component=galeri&s="&Sayfa-1&">< "&prev_page&"</a> "
end if

for t=d to Sayfa-1
if Sayfa > Sayfa-5 and t > Sayfa-5  and t > 0 then
Response.Write " <a class=pagenav href=?islem=bilesen&component=galeri&s=" & t & "><b>" & t & "</b></a> "
end if
next 

For d=Sayfa To Sayfa+4
if d = CInt(Sayfa) then
Response.Write "<span class=pagenav><b>" & d & "</b></span>"
elseif d > SayfaSayisi then
Response.Write ""
else
Response.Write " <a class=pagenav href=?islem=bilesen&component=galeri&s=" & d & "><b>" & d & "</b></a> " 
end if
Next


if Sayfa = SayfaSayisi then
Response.Write ""
else
Response.Write " <a class=pagenav href=?islem=bilesen&component=galeri&s="&Sayfa+1&"> "&next_page&" ></a> "
Response.Write " <a class=pagenav href=?islem=bilesen&component=galeri&s="&SayfaSayisi&">"&end_page&" >></a>"

End if
End If 
End If 
Response.Write "</div>"
end sub
sub kategori
set gs = baglanti.Execute("select * from gop_galeri where galid=" & guvenlik(request.querystring("galid")) & " order by resid DESC LIMIT "& (deste*Sayfa)-(deste) & "," & deste)

Set SQLToplam = baglanti.Execute("select count(resid) from gop_galeri") 
if gs.eof or gs.bof then
Response.Write "<td>"&not_picture&"</td></tr></table>"
else
TopKayit = SQLToplam(0) 

for z=1 to deste
if  gs.eof then exit for

Response.Write "<td><table><tr><td><b>"& gs("resadi") &"</b></td></tr><tr><td><a href=default.asp?islem=resim_goster&resid="&gs("resid")&" border=0><img src="& gs("resresim") &" width=""100"" align=""left"" onerror=""this.src='images/joomlasp.jpg'""></a></td></tr></td></tr><tr><td><strong>"&hit&":</strong>" & gs("rhit") & "</td>  </tr></table></td>"

if z mod 5 = 0 then response.write "</tr><tr>"

gs.MoveNext
next
gs.close
set gs=nothing
end if

Response.Write "</tr></table>"

' Istatistik bilgileri
Response.Write "<table width=""100%"" border=""0""><tr><td><strong>"& last_10_picture &"</strong></td><td><strong>"& hit_10_picture &"</strong></td><td><strong>"& down_10_picture &"</strong></td></tr><tr><td>"
  
   
set resson = baglanti.Execute("select * from gop_galeri order by resid DESC LIMIT 10")
do while not resson.eof
Response.Write "<a href=default.asp?islem=bilesen&component=galeri&act=goster&resid="&resson("resid")&" class=""smlink"">"&resson("resadi") & "</a><br>"
resson.movenext
loop
resson.close
set resson=nothing

Response.Write "</td><td>"

set reshit = baglanti.Execute("select * from gop_galeri order by rhit DESC LIMIT 10")
do while not reshit.eof
Response.Write "<a href=default.asp?islem=bilesen&component=galeri&act=goster&resid="&reshit("resid")&" class=""smlink"">"&reshit("resadi") & "</a><br>"
reshit.movenext
loop
reshit.close
set reshit=nothing
 Response.Write "</td><td>"
set resbot = baglanti.Execute("select * from gop_galeri order by rhit asc LIMIT 10")
do while not resbot.eof
Response.Write "<a href=default.asp?islem=bilesen&component=galeri&act=goster&resid="&resbot("resid")&" class=""smlink"">"&resbot("resadi") & "</a><br>"
resbot.movenext
loop
resbot.close
set resbot=nothing

Response.Write "</td></tr></table>"

' Istatistik sonu

Response.Write "<div align=""center"">"

If CInt(TopKayit) > CInt(deste) Then 
SayfaSayisi = CInt(TopKayit) / CInt(deste) 
If InStr(1,SayfaSayisi,",",1) > 1 Then SayfaSayisi = CInt(Left(SayfaSayisi,InStr(1,SayfaSayisi,",",1))) + 1 

If SayfaSayisi > 1 Then 
Response.Write "<a class=pagenav href=default.asp?islem=galeri_kategori&galid="&guvenlik(request.querystring("galid"))&"&s=1><< "&start_page&"</a> "
if Sayfa = 1 then
Response.Write ""
else
Response.Write "<a class=pagenav href=default.asp?islem=galeri_kategori&galid="&guvenlik(request.querystring("galid"))&"&s="&Sayfa-1&">< "&prev_page&"</a> "
end if

for t=d to Sayfa-1
if Sayfa > Sayfa-5 and t > Sayfa-5  and t > 0 then
Response.Write " <a class=pagenav href=default.asp?islem=galeri_kategori&galid="&guvenlik(request.querystring("galid"))&"&s=" & t & "><b>" & t & "</b></a> "
end if
next 

For d=Sayfa To Sayfa+4
if d = CInt(Sayfa) then
Response.Write "<span class=pagenav><b>" & d & "</b></span>"
elseif d > SayfaSayisi then
Response.Write ""
else
Response.Write " <a class=pagenav href=default.asp?islem=galeri_kategori&galid="&guvenlik(request.querystring("galid"))&"&s=" & d & "><b>" & d & "</b></a> " 
end if
Next


if Sayfa = SayfaSayisi then
Response.Write ""
else
Response.Write " <a class=pagenav href=default.asp?islem=galeri_kategori&galid="&guvenlik(request.querystring("galid"))&"&s="&Sayfa+1&"> "&next_page&" ></a> "
Response.Write " <a class=pagenav href=default.asp?islem=galeri_kategori&galid="&guvenlik(request.querystring("galid"))&"&s="&SayfaSayisi&">"&end_page&" >></a>"

End if
End If 
End If 
Response.Write "</div>"
end sub
sub goster
set gs = baglanti.Execute("select * from gop_galeri where resid=" & guvenlik(request.querystring("resid")) &";")

if gs.eof or gs.bof then
Response.Write "<td><br><br><br><br><center>"&not_picture&"</center><br><br><br><br></td></tr></table>"
else
resim_gosterim = gs("rhit")
baglanti.Execute("UPDATE gop_galeri set rhit="&resim_gosterim+1&" where resid=" & guvenlik(request.querystring("resid")) & " ;")

Response.Write "<td><table><tr><td><b>"& guvenlik(gs("resadi")) &"</b></td></tr><tr><td align=""center""><img src="& gs("resresim") &" align=""left"" width=""500"" onerror=""this.src='images/joomlasp.jpg'""></td></tr><tr><td>"

Response.Write "</td></tr><tr><td><strong>"&hit&":</strong>" & guvenlik(gs("rhit")) & "</td>  </tr></table></td>"
gs.close
set gs=nothing
End If 

Response.Write "</tr></table>"

' Istatistik bilgileri
Response.Write "<table width=""100%"" border=""0""><tr><td><strong>"& last_10_picture &"</strong></td><td><strong>"& hit_10_picture &"</strong></td><td><strong>"& down_10_picture &"</strong></td></tr><tr><td>"
  
   
set resson = baglanti.Execute("select * from gop_galeri order by resid DESC LIMIT 10")
do while not resson.eof
Response.Write "<a href=default.asp?islem=bilesen&component=galeri&act=goster&resid="&resson("resid")&" class=""smlink"">"&resson("resadi") & "</a><br>"
resson.movenext
loop
resson.close
set resson=nothing

Response.Write "</td><td>"

set reshit = baglanti.Execute("select * from gop_galeri order by rhit DESC LIMIT 10")
do while not reshit.eof
Response.Write "<a href=default.asp?islem=bilesen&component=galeri&act=goster&resid="&reshit("resid")&" class=""smlink"">"&reshit("resadi") & "</a><br>"
reshit.movenext
loop
reshit.close
set reshit=nothing
 Response.Write "</td><td>"
set resbot = baglanti.Execute("select * from gop_galeri order by rhit asc LIMIT 10")
do while not resbot.eof
Response.Write "<a href=default.asp?islem=bilesen&component=galeri&act=goster&resid="&resbot("resid")&" class=""smlink"">"&resbot("resadi") & "</a><br>"
resbot.movenext
loop
resbot.close
set resbot=nothing

Response.Write "</td></tr></table>"

' Istatistik sonu
end sub

]]></aspcode>
<sqlsil><![CDATA[
Baglanti.execute "DROP TABLE IF EXISTS `gop_galeri`;"
Baglanti.execute "DROP TABLE IF EXISTS `gop_galerikat`;"
]]>
</sqlsil>
<eklenti_yazar>JoomlASP</eklenti_yazar>
<eklenti_k>galeri</eklenti_k>
<eklenti_mail>info@joomlasp.com</eklenti_mail>
<eklenti_web>info@joomlasp.com</eklenti_web>
</item>